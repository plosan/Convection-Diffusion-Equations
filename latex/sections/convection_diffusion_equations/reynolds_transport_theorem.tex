
\subsection{Reynolds transport theorem}

The main result needed to derive the conservation laws of the subsequent subsections, namely, mass, momentum, energy and species conservation, is Reynolds transport theorem. This theorem is a generalization to higher dimensions of Leibniz integral rule:

\begin{theorem}[Leibniz integral rule \cite{kaplan2002advanced}]
	Let $U \subset \real$ be a closed interval and $I = [t_1, t_2]$, and let $a, b \colon I \rightarrow U$ be continuous functions with continuous derivative. Let $f \colon U \times I \rightarrow \real$, $(x,t) \mapsto f(x,t)$ be a continuous function such that $\pdv{f}{t}$ is also continuous. Then for all $t \in I$,
	\begin{equation} \label{eq:leibniz_rule}
		\frac{\dd}{\dd{t}} \int_{a(t)}^{b(t)} f(x,t) \dd{x} = 
		\int_{a(t)}^{b(t)} \pdv{f}{t}(x,t) \dd{x} + f(b(t),t) b'(t) - f(a(t),t) a'(t)
	\end{equation}
\end{theorem}

\noindent
Reynolds transport theorem allows us to compute the left--hand side of \eqref{eq:leibniz_rule} but in the more general context where $f$ is integrated over a bounded smooth control volume $\cv{}(t) \subset \real^m$ which depends upon time. 

\begin{theorem}[Reynolds transport theorem \cite{kundu2008fluid}]
	Let $U \subset \real^m$ be a compact set and let $\cv{}(t)$ be a control volume depending on time such that it is smooth and $\cv{}(t) \subset U$ for all $t \in I = [0, T]$ with $T > 0$. Let $\cs{}(t) = \partial \cv{}(t)$ be the boundary of $\cv{}(t)$ and let $F \in \mathcal{C}^1(U \times I, \real)$ be a scalar field. Then for all $t \in I$,
	\begin{equation} \label{eq:reynolds_transport_theorem}
		\frac{\dd}{\dd{t}} \int_\cvt F(\vb{x}, t) \dd{\vb{x}} = 
		\int_\cvt \frac{\partial F}{\partial t} (\vb{x}, t) \dd{\vb{x}} + 
		\int_\cst F(\vb{x}, t) \vb{b} \vdot \vb{n} \dd{S}
	\end{equation}
	where $\vb{b} \colon \cs{}(t) \rightarrow \real^m$ is the local velocity of the control surface.
\end{theorem}
\begin{proof}
	The moving control volume $\cv{}(t)$ can be seen as the image of an initial region $\cv{}(0)$ by a family of smooth maps $\xi \colon U \times I \subset \real^m \times \real \rightarrow \real^m$, that is to say, $\cv{}(t) = \xi(\cv{}(0),t)$ for all $t \in I$. Moreover, by fixing one time $t$, the mapping $\xi(\cdot, t) \colon \vb{}(0) \rightarrow \vb{}(t)$ can be assumed to be a diffeomorphism. Since $F$ is continuous, we can apply the Change of Variables Theorem taking $\vb{x} = \xi(\vb{x}_0,t)$,
	\begin{equation*}
		\int_\cvt F(\vb{x},t) \dd{\vb{x}} = 
		\int_{\cv{}(0)} F(\xi(\vb{x}_0,t), t) \abs{\det(\frac{\partial \xi}{\partial \vb{x}_0} (\vb{x}_0, t))} \dd{\vb{x}_0}
	\end{equation*}
	where the determinant of the jacobian matrix $\det(\frac{\partial \xi}{\partial \vb{x}_0} (\vb{x}_0, t))$ can be assumed to be positive for small enough $T$, hence the absolute value is dropped. Applying differentiation under the integral sign (Theorem \ref{theo:differentiation_under_the_integral_sign}) with respect to $t$ yields
	\begin{multline*}
		\frac{\dd}{\dd{t}} \int_\cvt F(\vb{x}, t) \dd{\vb{x}} = 
		\int_{\cv{}(0)} \pdv{t} 
		\left\{
		F(\xi(\vb{x}_0,t), t) \ \det(\frac{\partial \xi}{\partial \vb{x}_0} (\vb{x}_0, t))
		\right\}
		\dd{\vb{x}_0} 
		\\
		= 
		\int_{\cv{}(0)} 
		\pdv{t} \left\{ F(\xi(\vb{x}_0,t), t) \right\} \det(\frac{\partial \xi}{\partial \vb{x}_0} (\vb{x}_0, t)) \dd{\vb{x}_0} + 
		\int_{\cv{}(0)} F(\xi(\vb{x}_0,t), t) \, \pdv{t} \left\{ \det(\frac{\partial \xi}{\partial \vb{x}_0} (\vb{x}_0, t)) \right\} \dd{\vb{x}_0}
	\end{multline*}
	On the one hand,
	\begin{equation*}
		\pdv{t} \left\{ F(\xi(\vb{x}_0,t), t) \right\} \det(\frac{\partial \xi}{\partial \vb{x}_0} (\vb{x}_0, t)) = 
		\left\{ 
		\frac{\partial F}{\partial t} (\xi(\vb{x}_0, t), t) + 
		\grad{F(\xi(\vb{x}_0, t), t)} \vdot \xi_t (\vb{x}_0, t)
		\right\}
		\det(\frac{\partial \xi}{\partial \vb{x}_0} (\vb{x}_0, t))
	\end{equation*}
	where $\xi_t = \pdv{\xi}{t}$. On the other hand, using matrix calculus,
	\begin{equation*}
		F(\xi(\vb{x}_0,t), t) \, \pdv{t} \left\{ \det(\frac{\partial \xi}{\partial \vb{x}_0} (\vb{x}_0, t)) \right\} = 
		F(\xi(\vb{x}_0,t), t) \det(\frac{\partial \xi}{\partial \vb{x}_0} (\vb{x}_0, t)) \, \div{\xi_t(\vb{x}_0,t)}
	\end{equation*}
	Thereby the integral is written as
	\begin{multline*}
		\frac{\dd}{\dd{t}} \int_\cvt F(\vb{x}, t) \dd{\vb{x}} = 
		\int_{\cv{}(0)} 
		\left\{
		\frac{\partial F}{\partial t} + \grad{F} \vdot \xi_t + F \div{\xi_t}
		\right\} \det(\frac{\partial \xi}{\partial \vb{x}_0}) \dd{\vb{x}_0} 
		\\ = 
		\int_{\cv{}(0)} 
		\left\{	\frac{\partial F}{\partial t} + \div(F \xi_t) \right\} \det(\frac{\partial \xi}{\partial \vb{x}_0}) \dd{\vb{x}_0}
	\end{multline*}
	So as to obtain an integral over $\cv{}(t)$, the previous change of variables is reverted, that is, $\vb{x}_0 = \xi^{-1}(\vb{x}, t)$. In order not to complicate notation, let $\vb{b}(\vb{x},t) = \xi_t(\xi^{-1}(\vb{x},t),t)$, then
	\begin{equation*}
		\frac{\dd}{\dd{t}} \int_\cvt F(\vb{x}, t) \dd{\vb{x}} = 
		\int_\cvt 
		\left\{ \frac{\partial F}{\partial t}  + \div(F \vb{b}) \right\} (\vb{x}, t) \dd{\vb{x}}
	\end{equation*}
	For a fixed $\vb{x}_0 \in \cv{}(0)$, $\xi(\vb{x}_0, \cdot)$ is a function of time giving how $\vb{x}_0$ moves, hence $\xi_t(\vb{x}_0, t)$ is the instantaneous velocity of $\vb{x}_0$. To end, an application of divergence theorem yields the final formula
	\begin{equation*}
		\frac{\dd}{\dd{t}} \int_\cvt F(\vb{x}, t) \dd{\vb{x}} = 
		\int_\cvt \frac{\partial F}{\partial t} (\vb{x}, t) \dd{\vb{x}} +
		\int_\cst F(\vb{x}, t) \vb{b} \vdot \vb{n} \dd{S}
	\end{equation*}
\end{proof}

In an intuitive manner, Reynolds tranport theorem quantifies how a quantity over a control volume varies when the control volume itself depends on time due to transport phenomena, diffusion, etc. 






