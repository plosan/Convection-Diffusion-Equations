
\section{Measure Theory} \label{ap:measure_theory}

In this appendix we gather 

\subsection{Measurable spaces and measurable functions}

In this appendix, $X$ will denote an arbitrary set.

\begin{definition*}
	A $\sigma$--algebra of sets of $X$ is a family $\mathcal{A}$ of subsets of $X$,
	$\mathcal{A} \subset \mathcal{P}(X)$, such that:
	\begin{enumeratedef}
		\item $X \in \mathcal{A}$,
		\item $A \in \mathcal{A}$ if and only if $A^c = X \setminus A \in \mathcal{A}$,
		\item If $\{ A_n \}_{n \geq 1} \subset \mathcal{A}$ is a countable
		family of sets, then $\cup_{n \geq 1} A_n \in \mathcal{A}$.
	\end{enumeratedef}
	We say the pair $(X, \mathcal{A})$ is a measurable space.
\end{definition*}

As examples, both $\{\emptyset, X\}$ and $\mathcal{P}(X)$ are $\sigma$--algebras
on $X$. The former is the trivial $\sigma$--algebra and is of no great interest.
The latter is the power set of $X$, which is usually too big to work in. In many
cases, it is convenient for a $\sigma$--algebra to contain certain subsets of
$X$. This is made precise in the following definition:

\begin{definition*}
	The $\sigma$--algebra generated by a set $Z \subset \mathcal{P}(X)$ is
	\[
		\generated{Z} = \bigcap_{\substack{\mathcal{A} \ \sigma\text{--algebra} \\ Z \subset \mathcal{A}}} \mathcal{A}	
	\]
\end{definition*}

There exists many $\sigma$--algebras on $\real$, nonetheless we are interested
on the smallest one containing all the open intervals. This is known as Borel's
$\sigma$--algebra.

\begin{definition*}
	Borel's $\sigma$--algebra, denoted by $\mathcal{B}$, is the
	$\sigma$--algebra generated by $Z = \{ (a,b) \subset \real \mid a < b \}$.
	The elements of $\mathcal{B}$ are called Borel's sets.
\end{definition*}

\begin{definition*}
	Let $(X, \mathcal{A})$ be a measurable space. A function $f \colon X \to
	\real$ is said to be $\mathcal{A}$--measurable (or measurable if
	$\mathcal{A}$ is clear) if $f^{-1}(B) \in \mathcal{A}$ for all $B \in
	\mathcal{B}$. We denote by $\mathcal{M}(X, \mathcal{A})$ the set of
	measurable functions.
\end{definition*}

In order to define Lebesgue's integral, it is convenient to consider functions
which take infinite value at certain points, as well as the positive and
negative parts of a function. To do so, we need the following definitions:

\begin{definition*}
	\begin{enumeratedef}
		\item[]
		\item The extended real line is $\real^\ast = \real \cup \{-\infty, +\infty\}$.
		\item The extended Borel $\sigma$--algebra is defined to be
		\[
			\mathcal{B}^\ast = \{
			B, \, B \cup \{ + \infty \}, \, B \cup \{ - \infty \}, \, B \cup \{ -\infty, +\infty \}	
			\}_{B \in \mathcal{B}}
		\]
	\end{enumeratedef}
\end{definition*}

The definition of measurable function extends naturally to $\real^\ast$, that is
to say, if $(X, \mathcal{A})$ is a measurable space, a function $f \colon X
\rightarrow \real^\ast$ is said to be measurable whenever $f^{-1}(B) \in \mathcal{A}$
for all $B \in \mathcal{B}^\ast$.

\begin{definition*}
	Let $(X, \mathcal{A})$ be a measurable space. The indicator function of a
	set $E \in \mathcal{A}$ is 
	\[
		\mathbb{I}_E(x) = 
		\left\{
			\begin{aligned}
				&1	& &\text{if } x \in E 		\\
				&0	& &\text{if } x \not\in E
			\end{aligned}
		\right.
	\] 
\end{definition*}

\begin{definition*}
	Let $(X, \mathcal{A})$ be a measurable space and $f \colon X \rightarrow
	\real$. We define the positive and negative parts of $f$ point by point as
	\begin{align*}
		f^+(x) &= \max{\{ f(x), 0 \}} \\
		f^-(x) &= \max{\{ -f(x), 0 \}}
	\end{align*}
\end{definition*}

\begin{prop}
	Let $(X, \mathcal{A})$ be a measurable space.
	\begin{enumerateprop}
		\item The indicator function of a set $E \in \mathcal{A}$ is measurable.
		\item If $f \colon X \rightarrow \real$ is measurable, then $f^+$ and $f^-$ are measurable.
	\end{enumerateprop}
\end{prop}

In the real line $\real$ our natural notion of measure is the length. For
instance, for $a, b \in \real$, we say the interval $(a, b)$, has length $b -
a$. This is also true for $(a, b]$, $[a, b)$ and $[a,b]$. In $\real^2$ and in
$\real^3$ our notions of measure are surface and volume, respectively. For
$\real^n$, although not so obvious, the notion of measure is the
$n$--dimensional volume. The following definition generalizes the notion of
measure to any space suitable enough to be measured.

\begin{definition*}
	A measure on a measurable space $(X, \mathcal{A})$ is a mapping $\mu \colon
	\mathcal{A} \rightarrow \real^\ast$ such that:
	\begin{enumeratedef}
		\item $\mu(\emptyset) = 0$.
		\item $\mu(A) \geq 0$ for all $A \in \mathcal{A}$.
		\item $\sigma$--additivity: if $\{ A_i \}_{i \geq 1} \subset \mathcal{A}$ is a countable
		family of measurable sets and $A_i \cap A_j = \emptyset$ whenever $i \neq j$, then
		\[
			\mu\left( \displaystyle\bigcup_{i = 1}^\infty A_i \right) = \sum_{i \geq 1} \mu(A_i)	
		\]
	\end{enumeratedef}
	$(X, \mathcal{A}, \mu)$ is said to be a measure space.
\end{definition*}

The natural notion of $n$--dimensional volume in $\real^n$ that we have is given
by Lebesgue's measure $\lambda_n$. Take $a_1 \leq b_1, \ldots, a_n \leq b_n$ and
consider the intervals $[a_1, b_1], \ldots, [a_n, b_n] \subset \real$. Then the
$n$--dimensional rectangle $\prod_{i = 1}^n [a_i, b_i] = [a_1, b_1] \times
\cdots \times [a_n, b_n]$ is a subset of $\real^n$ and its $n$--dimensional
volume is
\[
	\lambda_n\left( \prod_{i = 1}^n [a_i, b_i] \right) = \prod_{i=1}^n (b_i - a_i)
\]
Assume $f \colon U \rightarrow \real$ is a continuous function defined on a
compact subset $U$ of $\real^n$, so that its integral over $U$ is finite and given by
\[
	\int_U f \dd{x} = \int_U f(x_1, \ldots, x_n) \dd{x_1} \cdots \dd{x_n}	
\]
The notation $\dd{x_1} \cdots \dd{x_n}$, besides telling us with respect to what
variables the integral is being computed, it says how we are measuring in $U$.
This way of measuring is the one given by Lebesgue's measure. We shall not
discuss the construction of $\lambda_n$ on $\real^n$. The only thing we need in
order to continue is its uniqueness, that is to say, Lebesgue's measure on
$\real^n$ is the only measure that gives the usual notion of $n$--dimensional
volume.

\begin{definition*}
	Let $(X, \mathcal{A}, \mu)$ be a measure space.
	\begin{enumeratedef}
		\item A set $E \in \mathcal{A}$ is said to be a null set if $\mu(E) = 0$.
		\item Let $P$ be a proposition. We say $P$ is true $\mu$--almost
		everywhere ($\mu$--a.e.) if there exists $N \in \mathcal{A}$ such that
		$\mu(N) = 0$ and $P$ is true on $N^c = X \setminus N$.
	\end{enumeratedef}	
\end{definition*}


\subsection{Lebesgue's integral}

Let us begin by remembering the following theorem:

\begin{theorem}[Lebesgue's theorem]
	Let $A = \prod_{i=1}^n [a_i, b_i] \subset \real^n$ be a compact rectangle
	and $f \colon A \rightarrow \real$ a bounded function. Then $f$ is
	Riemann--integrable in $A$ if, and only if, $\mathrm{disc}(f) = \{ x \in U
	\mid f \text{ is not continuous at } x \}$ has zero $\lambda_n$ measure.
\end{theorem}

Lebesgue's theorem asserts that a function is integrable in the sense of Riemann
if the set where it is discontinuous is not too big (in the sense made precise
previously). This is not true for Lebesgue's integral, that is to say, a
function can be non--where continuous and integrable in Lebesgue's sense.
Although not so computationally useful as Riemann's integral, it is a extremely
powerful tool in advanced analysis.

Let $(X, \mathcal{A}, \mu)$ be a measure space and consider the set of positive
measurable functions $\mathcal{M}^+(X, \mathcal{A}) = \{ f \in \mathcal{M}(X,
\mathcal{A}) \mid f \geq 0 \, \text{for all } x \in X \}$. The idea behind
Lebesgue's integral for functions in $\mathcal{M}^+(X, \mathcal{A})$ is to
approximate them by functions $\varphi \colon X \rightarrow \real$ taking only
finitely many values.

\begin{definition*}
	A function $\varphi \colon X \rightarrow \real$, $\varphi \in
	\mathcal{M}^+(X, \mathcal{A})$, is said to be simple if $\abs{\image{\varphi}} < \infty$.
\end{definition*}

Observe that every simple function can be written in the form $\varphi =
\sum_{i=1}^n a_i \mathbb{I}_{E_i}$, where $n = \abs{\image{\varphi}}$, $a_1, \ldots, a_n \geq 0$ and $E_1,
\ldots, E_n \in \mathcal{A}$. Nonetheless, it is convenient to have a canonical representation for simple functions.

\begin{definition*}
	The canonical representation of a simple function $\varphi \in \mathcal{M}^+(X, \mathcal{A})$ is
	\[
		\varphi = \sum_{j=1}^r b_i\mathbb{I}_{A_i} \quad \text{such that} \quad
		\left\{
			\begin{aligned}
				A_i \cap A_j &= \emptyset 	& &\text{if } i \neq j \\
				b_i &\neq b_j				& &\text{if } i \neq j \\
				b_i &\neq 0					& &\text{for } i = 1, \ldots, r
			\end{aligned}
		\right.
	\]
\end{definition*}

Using the previous definition, we can define Lebesgue's integral for simple functions:

\begin{definition*}
	Let $\varphi \colon X \rightarrow \real$, $\varphi \in \mathcal{M}^+(X,
	\mathcal{A})$, be a simple function with canonical representation
	\[
		\varphi = \sum_{j=1}^r b_i\mathbb{I}_{A_i}
	\]
	Then we define Lebesgue's integral for $\varphi$ by
	\[
		\int_X \varphi \dd{\mu} = \sum_{j=1}^r b_j \mu(A_j)	
	\]
	where we set $b_j \mu(A_j) = 0$ if $b_j = 0$ for any $\mu(A_j) \in [0, \infty]$.
\end{definition*}

\begin{definition*}
	Let $f \in \mathcal{M}^+(X, \mathcal{A})$. We define the Lebesgue integral
	of $f$ over $X$ to be
	\[
		\int_X f \dd{\mu} = 
		\sup_{\substack{\varphi \leq f \\ \varphi \text{ simple}}} \int_X \varphi \dd{\mu}	
	\]
	If $E \in \mathcal{A}$, then $f \mathbb{I}_E \in \mathcal{M}^+(X,
	\mathcal{A})$ and we define the Lebesgue integral of $f$ over $E$ by
	\[
		\int_E f \dd{\mu} = \int_X f \mathbb{I}_E \dd{\mu}
	\] 
\end{definition*}

Once Lebesgue's integral is defined for functions $\mathcal{M}^+(X,
\mathcal{A})$, we would like to extend it to functions taking both positive and
negative values.

\begin{definition*}
	We say a function $f \colon X \rightarrow \real$ is integrable if:
	\begin{enumeratedef}
		\item $f$ is a measurable function,
		\item Both $f^+$ and $f^-$, which are measurable functions, have finite integral.
	\end{enumeratedef}
	If $f$ is an integrable function, we define the Lebesgue integral of $f$ over $X$ by
	\[
		\int_X f \dd{\mu} = \int_X f^+ \dd{\mu} - \int_X f^- \dd{\mu}	
	\]
	and
	\[
		\int_E f \dd{\mu} = \int_X f \mathbb{I}_E \dd{\mu} = \int_E f^+ \dd{\mu} - \int_E f^- \dd{\mu}	
	\]
	whenever $E \in \mathcal{A}$. We denote the set of integrable functions by $L(X, \mathcal{A}, \mu)$.
\end{definition*}

\subsection{\texorpdfstring{$L^p$}{L--p} spaces}

Let $(X, \mathcal{A}, \mu)$ be a measure space. Our aim is to define a norm on
$L(X, \mathcal{A}, \mu)$ that makes it into a complete space, \ie a space where
every Cauchy sequence has limit. Recall that a norm on a $\real$--vector space
$F$ is a mapping $\norm{\cdot} \colon F \rightarrow \real$ that satisfies the
following:
\begin{enumeratedef}
	\item Non--negative: $\norm{x} \geq 0$ for all $x \in F$.
	\item Non--degenerate: $\norm{x} = 0$ if and only if $x = 0$.
	\item Product by scalars: $\norm{\lambda x} = \abs{\lambda} \norm{x}$ for all $x \in F$ and $\lambda \in \real$.
	\item Triangular inequality: $\norm{x + y} \leq \norm{x} + \norm{y}$ for all $x, y \in F$.
\end{enumeratedef}

We begin by defining the mapping
\[
	\begin{aligned}
		N_\mu \colon L(X, \mathcal{A}, \mu) &\longrightarrow \real \\
		f &\longmapsto \int_X \abs{f} \dd{\mu}
	\end{aligned}
\]
which satisfies the following:
\begin{enumerateprop}
	\item $N_\mu(f) \geq 0$.
	\item $N_\mu(f) < \infty$ because $f$ is integrable.
	\item $N_\mu(\alpha f) = \abs{\alpha} N_\mu(f)$ for all $\alpha \in \real$.
	\item $N_\mu(f + g) \leq N_\mu(f) + N_\mu(g)$.
\end{enumerateprop}
Nonetheless, $N_\mu(f) = 0$ does not imply $f \equiv 0$ in $X$. The reason for
this is that $f$ may take values different from $0$ in null sets, that is to
say, $N_\mu(f) = 0$ as long as $f = 0$ $\mu$--a.e. We say that $N_\mu$ is a
seminorm. Observe that redefining a function $f \in L(X, \mathcal{A}, \mu)$ in a
null set does not change $\int_X f \dd{\mu}$. Therefore, in order to make
$N_\mu$ into a norm, we shall relate the functions in $L(X, \mathcal{A}, \mu)$
that differ only in null sets.

\begin{definition*}
	In $L(X, \mathcal{A}, \mu)$ we define the relation
	\begin{equation} \label{eq:equivalence_relation}
		f \sim_\mu g \iff f = g \ \mu\text{--a.e.}	
	\end{equation}
\end{definition*}

\begin{prop}
	Relation \eqref{eq:equivalence_relation} is an equivalence relation in $L(X, \mathcal{A}, \mu)$. 
\end{prop}
\begin{proof}
	Reflexivity and symmetry are trivially satisfied by $\sim_\mu$. Regarding
	the transitivity, assume $f \sim_\mu g$ and $g \sim_\mu h$. Let $N_1 \in
	\mathcal{A}$ be the null set where $f$ and $g$ differ. Similarly, let $N_2
	\in \mathcal{A}$ be the null set where $g$ and $h$ differ. Then $f$ and $h$
	differ in a measurable set $N \subset N_1 \cup N_2$, thus $\mu(N) \leq
	\mu(N_1 \cup N_2) \leq \mu(N_1) + \mu(N_2) = 0$, which implies $f \sim_\mu h$.
\end{proof}

Finally we can start defining the celebrated $L^p$ spaces:

\begin{definition*}
	We define the space $L^1(X, \mathcal{A}, \mu)$ or Lebesgue space by
	\[
		L^1(X, \mathcal{A}, \mu) = \quotient{L(X, \mathcal{A}, \mu)}{\sim_\mu}
	\]
	When both $\mathcal{A}$ and $\mu$ are clear, we shall write $L^1(X, \mathcal{A}, \mu) = L^1(X)$.
\end{definition*}

\begin{definition*}
	On $L^1(X, \mathcal{A}, \mu)$ we define the $L^1$--norm as
	\[
		\norm{f}_{L^1(X)} = \norm{f}_1 = \int_X \abs{f} \dd{\mu}
	\]
\end{definition*}


\begin{prop} \label{eq:integral_does_not_depend_on_representative}
	If $[f] \in L^1(X)$ and $g \in [f]$, then $\int_X \abs{f} \dd{\mu} = \int_X
	\abs{g} \dd{\mu}$.
\end{prop}
\begin{proof}
	Let $N \in \mathcal{A}$ be the null set where $f$ and $g$ differ, \ie $f
	\neq g$ in $N \in \mathcal{A}$ and $\mu(N) = A$. Let $M = X \setminus N$,
	then
	\begin{align*}
		\int_X \abs{f} \dd{\mu} &= 
		\int_X \abs{f} (\mathbb{I}_M + \mathbb{I}_N) \dd{\mu} = 
		\int_X \abs{f} \mathbb{I}_M \dd{\mu} + \int_X \abs{f} \mathbb{I}_N \dd{\mu} = 
		\int_X \abs{f} \mathbb{I}_M \dd{\mu} \\ &=
		\int_X \abs{g} \mathbb{I}_M \dd{\mu} = 
		\int_X \abs{g} \mathbb{I}_M \dd{\mu} + \int_X \abs{g} \mathbb{I}_N \dd{\mu} = 
		\int_X \abs{g} \dd{\mu}
	\end{align*}
\end{proof}

\begin{theorem}
	$(L^1(X), \norm{\cdot}_1)$ is a normed vector space.
\end{theorem}
\begin{proof}
	$\norm{\cdot}_1$ satisfies the non--negative, the product by scalars and the
	triangular inequality properties since $N_\mu$ does, thus it only remains to
	prove the non--degenerate property. Let $[f] \in L^1(X)$ such that
	$\norm{f}_1 = 0$, then $\abs{f} = 0$ $\mu$--a.e., which is equivalent to $f = 0$
	$\mu$--a.e., which impies $f \in [0]$, so $\norm{\cdot}_1$ is non--degenerate.
\end{proof}

The elements of $L^1(X)$ are the equivalence classes of $L(X, \mathcal{A}, \mu)$
given by the equivalence relation \eqref{eq:equivalence_relation}. However,
proposition \ref{eq:integral_does_not_depend_on_representative} tells us that
the integral does not depend on the representative of the class, hence we shall
become less formal and treat the elements of  $L^1(X)$ as functions.

Now we shall study the generalization of Lebesgue's space. Let $p \in (1,\infty)$
and consider the measurable functions $f \colon X \rightarrow \real$ such that
\[
	\int_X \abs{f}^p \dd{\mu} < \infty	
\]
We will denote by $L^p(X, \mathcal{A}, \mu)$ the set of equivalence classes of
functions $\abs{f}^p \in L(X, \mathcal{A}, \mu)$ with the equivalence relation
$\sim_\mu$. When both $\mathcal{A}$ and $\mu$ are clear from the context, we
shall write $L^p(X)$ in place of $L^p(X, \mathcal{A}, \mu)$.

\begin{definition*}
	On $L^p(X)$ we define the $L^p$--norm by
	\[
		\norm{f}_{L^p(X)} = \norm{f}_p = \left( \int_X \abs{f}^p \dd{\mu} \right)^{1/p}	
	\]
	for $f \in L^p(X)$.
\end{definition*}

The difficult task on demonstrating that $\norm{\cdot}_p$ is proving the
triangular inequality. In the context of $L^p$ spaces, this is known as Minkowski's inequality:

\begin{theorem}[Minkowski's inequality] \label{teo:minkowski}
	Let $p \geq 1$ and $f, g \in L^p(X)$. Then $f + g \in L^p(X)$ and $\norm{f +
	g}_p \leq \norm{f}_p + \norm{g}_p$.
\end{theorem}

\begin{theorem}[Riesz--Fischer] \label{teo:riesz_fischer}
	$(L^p(X), \norm{\cdot}_p)$ is a complete space for $1 \leq p < \infty$.
\end{theorem}

Theorem \ref{teo:minkowski} tells us that $L^p(X)$, endowed with the
$L^p$--norm, is a normed vector space, whereas \ref{teo:riesz_fischer} asserts
that is is complete. Hence $(L^p(X), \norm{\cdot}_p)$ is a complete normed
vector space, \ie a Banach space, so we can do analysis on it.

In the definition of $L^p(X)$, we have asked for $1 \leq p < \infty$.
Nonetheless, when $p = \infty$, we encounter the $L^\infty(X)$ space, formed by
the essentially bounded functions, \ie functions that are bounded almost
everywhere except maybe on a null set. The $L^\infty$--norm on $L^\infty(X)$ is given by
\[
	\norm{f}_{L^\infty(X)} = 
	\norm{f}_\infty = 
	\inf{\{ C \geq 0 \mid \abs{f} \leq C \ \mu\text{--almost everywhere} \}}
\]
As it could be anticipated, $(L^\infty(X), \norm{\cdot}_\infty)$ is also a Banach space.

\clearpage
\subsection{Differentiation under the integral sign}

In this appendix we gather two important theorems needed to justify some steps
in the derivation of conservation laws in section
\ref{sec:the_convection_diffusion_equations}. Despite these results are basic, a
previous study of real analysis is required in order to understand and prove
them. A good reference for the interested reader is Real and Complex Analysis of
Walter Rudin \cite{rudin1987real}. 

\subsection{Differentiation under the integral sign}

Differentiation under the integral sign allows us to compute the derivative of
an integral of a function of two parameters in a simple way. It is needed, for
instance, when the mass conservation law or the heat diffusion equation are
derived. 

Let $(X, \mathcal{A}, \mu)$ be a measure space and let $[a, b] \subset \real$.
Hereinafter we deal with functions $f \colon X \times [a,b] \rightarrow \real$,
where $t \in [a, b]$ is the parameter on which $f$ depends. We assume that
$f(\cdot, t)$ is a measurable function for each $t \in [a, b]$.

\begin{theorem}[Differentiation under the integral sign]
	\label{theo:differentiation_under_the_integral_sign} Let $F(t) = \int_X
	f(x,t) \dd{\mu}$. Assume that
	\begin{enumerate}[label={(\roman*)}, topsep=0pt]
		\item $f(x,t_0)$ is an integrable function for some $t_0 \in
		[a,b]$.
		\item $\dfrac{\partial f}{\partial t}(x,t)$ is defined for all
		$(x, t) \in X \times [a, b]$.
		\item There exists an integral function $g \colon X \rightarrow \real$
		such that $\abs{\dfrac{\partial f}{\partial t} (x,t)} \leq
		g(x)$ for all $(x, t) \in X \times [a, b]$.
	\end{enumerate}
	Then $F$ is a differentiable function and
	\[
		F'(t) = \frac{\dd}{\dd t} F(t) = \int_X \frac{\partial f}{\partial t}(x,t) \dd{\mu}
	\]
\end{theorem}

For the applications needed in this project, $X = \real^m$ with $1 \leq m \leq
3$, $\mathcal{A}$ is the Borel $\sigma$--algebra on $\real^m$ and $\mu$ is
Lebesgue's measure on $\real^m$, which for most of the ``natural'' sets of
$\mathcal{A}$ coincides with the usual notion of $m$--dimensional volume.

\subsection{Lebesgue's differentiation lemma}

A common way to derive a conservation law is to integrate some functions in a
control volume, then apply Differentiation under the integral sign to obtain an
integral equation and finally get to a differential equation using Lebesgue's
differentiation lemma. 

An intuitive way to understand and to motivate Lebesgue's differentiation lemma
is the following. Let $f \colon \real \to \real$ be a continuous function, let
$a \in \real$ be a fixed point and let $F(x) = \int_a^x f(y) \dd{y}$, which is a
differentiable function. Due to a corollary of the Fundamental Theorem of
Calculus, we have $F'(x) = f(x)$. Using the definition of derivative,
\[
	F'(x) = 
	\lim_{h \to 0} \frac{F(x + h) - F(x)}{h} = 
	\lim_{h \to 0} \frac{1}{h} \left\{ \int_a^{x + h} f(y) \dd{y} - \int_a^{x} f(y) \dd{y} \right\} = 
	\lim_{h \to 0} \frac{1}{h} \int_x^{x + h} f(y) \dd{y} = f(x)
\]
Notice that the integral is divided by the length of the interval $[x, x+h]$,
otherwise the limit would be zero. Lebesgue's lemma generalizes the previous
equality by considering functions $f \colon \real^n \to \real$ and integrating
them on open balls $B(x_0, r) = \{ x \in \real^n \mid \norm{x -
x_0} < r\}$. Furthermore, the integral is divided by the $n$--dimensional
volume of $B(x_0, r)$, which is denoted by $\abs{B(x_0, r)}$.

\begin{theorem}[Lebesgue's differentiation lemma \cite{evans1998pde}]
	\label{eq:lebesgue_differentiation_lemma} Let $f \colon \real^n \rightarrow
	\real$ be a locally integrable function.
	\begin{enumerate}[label={(\arabic*)}, topsep=0pt]
		\item Then for almost everywhere point $x_0 \in \real^n$,
		\[
			\frac{1}{\abs{B(x_0, r)}} \int_{B(x_0,r)} f(x) \dd{x} \to f(x_0) 
			\quad \text{as } r \to 0
		\]
		\item In fact, for almost everywhere point $x_0 \in \real^n$,
		\[
			\frac{1}{\abs{B(x_0, r)}} \int_{B(x_0,r)} \abs{f(x) - f(x_0)} \dd{x} \to 0 
			\quad \text{as } r \to 0
		\]		
	\end{enumerate}
\end{theorem}
