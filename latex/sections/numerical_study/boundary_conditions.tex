
\subsection{Treatment of boundary conditions}

In Cauchy problems involving Partial Differential Equations (PDEs), there exist several kinds of boundary conditions which must be prescribed in order to guarantee the existence and uniqueness of solution, although in this project only two will be considered. So as to illustrate how these conditions are set, let $U \subset \real^m$ be a bounded open subset of $\real^m$. The diffusion equation, which describes the evolution in time of the density of a magnitude $u$ such as a heat or chemical substance, is the PDE
\begin{equation} \label{eq:boundary_conditions_heat_equation}
	u_t - \Delta u = f(\vb{x}, t) \quad (\vb{x}, t) \in U \times (0,\infty)
\end{equation}
where $\Delta = \sum_{i=1}^{m} \pdv[2]{}{x_i}$ is Laplace's operator and $f$ models the internal sources for magnitude $u$. Let $g \colon U \rightarrow \real$ be the initial value for $u$. Then the typical Cauchy problem for diffusion equation is
\begin{equation} \label{eq:boundary_conditions_problem}
	\left\{
	\begin{aligned}
		&u_t - \Delta u = f(\vb{x}, t) & &\text{in } U \times (0,\infty) \\
		&u = g & &\text{on } U \times \{ t = 0 \} \\
		&\text{Boundary conditions}
	\end{aligned}
	\right.
\end{equation}
The boundary conditions considered are:
\begin{itemize}
	\item Dirichlet boundary condition: the value of $u$ is prescribed on $\partial U \times (0,\infty)$, that is to say, if $d \colon \partial U \times (0,\infty) \rightarrow \real$, $(\vb{x}, t) \mapsto d(\vb{x}, t)$ describes the boundary condition, then \eqref{eq:boundary_conditions_problem} is written as
	\begin{equation}
		\left\{
		\begin{aligned}
			&u_t - \Delta u = f(\vb{x}, t) & &\text{in } U \times (0,\infty) \\
			&u = g & &\text{on } U \times \{ t = 0 \} \\
			&u = d & &\text{on } \partial U \times (0,\infty)
		\end{aligned}
		\right.
	\end{equation}
	When \eqref{eq:boundary_conditions_heat_equation} is thought of as describing the propagation of heat, then $d$ fixes the temperature at the boundary of $U$ for each time.
	\item Neumann boundary condition: the normal derivative of $u$ to the boundary of $U$ is prescribed on $\partial U \times (0,\infty)$, \ie if $n \colon \partial U \times (0,\infty) \rightarrow \real$ describes the boundary condition, then \eqref{eq:boundary_conditions_problem} is written as
	\begin{equation}
		\left\{
		\begin{aligned}
			&u_t - \Delta u = f(\vb{x}, t) 	& &\text{in } U \times (0,\infty) \\
			&u = g 							& &\text{on } U \times \{ t = 0 \} \\
			&\partial_{\nu} u = n 			& &\text{on } \partial U \times (0,\infty)
		\end{aligned}
		\right.
	\end{equation}
	where $\nu$ is the outer normal vector to $\partial U$. In terms of heat, this boundary condition sets the conduction heat transfer through $U$ for each time.
\end{itemize}

The numerical treatment of boundary conditions is straightforward, speacially when a cartesian mesh on a rectangular domain is used.

\begin{figure}[h]
	\centering
	\begin{minipage}{.5\textwidth}
		\centering
		\begin{tikzpicture}
			\draw[white] ({0.75-2.75},0) -- ({0.75+2.75},0);
			% Control volumes
			\draw[black, thick, dashed] (-0.2,0.0) -- ++(1.7,0.0);
			\draw[black, thick, dashed] (-0.2,1.5) -- ++(1.7,0.0);
			\draw[black, thick, dashed] (-0.2,3.0) -- ++(1.7,0.0);
			\draw[black, thick, dashed] (-0.2,4.5) -- ++(1.7,0.0);
			\draw[black, thick, dashed] (0.0,-0.2) -- (0.0,4.7);
			\draw[black, very thick] (1.5,-0.2) -- (1.5,4.7);
			% Nodes
			\foreach \x in {0,1}
			\foreach \y in {0,1,2}
			\filldraw[greenNode] ({0.75+0.75*\x},{0.75+1.50*\y}) circle (2pt);
			% Nodes text
			\node[greenNode, yshift=3mm] at (0.75,0.75) {$W$};
			\node[greenNode, yshift=3mm] at (0.75,2.25) {$P$};
			\node[greenNode, yshift=3mm] at (0.75,3.75) {$E$};
			\node[circle, inner sep=0pt, outer sep=0pt, greenNode, yshift=3mm, fill=white] at (1.50,2.25) {$e$};
			\node[greenNode, anchor=west] at (1.50,2.25) {$\phi_e = \phi_E$}; 
		\end{tikzpicture}
		\captionsetup{width=0.9\textwidth}
		\caption{Dirichlet boundary condition.}
		\label{fig:boundary_conditions_dirichlet}
	\end{minipage}%
	\begin{minipage}{.5\textwidth}
		\centering
		\begin{tikzpicture}
			\draw[white] ({0.75-2.75},0) -- ({0.75+2.75},0);
			% Control volumes
			\draw[black, thick, dashed] (-0.2,0.0) -- ++(1.7,0.0);
			\draw[black, thick, dashed] (-0.2,1.5) -- ++(1.7,0.0);
			\draw[black, thick, dashed] (-0.2,3.0) -- ++(1.7,0.0);
			\draw[black, thick, dashed] (-0.2,4.5) -- ++(1.7,0.0);
			\draw[black, thick, dashed] (0.0,-0.2) -- (0.0,4.7);
			\draw[black, very thick] (1.5,-0.2) -- (1.5,4.7);
			% Nodes
			\foreach \x in {0,1}
			\foreach \y in {0,1,2}
			\filldraw[greenNode] ({0.75+0.75*\x},{0.75+1.50*\y}) circle (2pt);
			% Nodes text
			\node[greenNode, yshift=3mm] at (0.75,0.75) {$W$};
			\node[greenNode, yshift=3mm] at (0.75,2.25) {$P$};
			\node[greenNode, yshift=3mm] at (0.75,3.75) {$E$};
			\node[circle, inner sep=0pt, outer sep=0pt, greenNode, yshift=3mm, fill=white] at (1.50,2.25) {$e$};
			% Arrow
			\draw[->, red, thick] (1.00,2.25) -- ++(1,0) node[anchor=west]{$j_e = j_E$};
		\end{tikzpicture}
		\captionsetup{width=0.9\textwidth}
		\caption{Neumann boundary condition.}
		\label{fig:boundary_conditions_neumann}
	\end{minipage}
\end{figure}

\noindent
In the case of a Dirichlet boundary condition, such as the one shown in figure \ref{fig:boundary_conditions_dirichlet}, the value at face must be equal to the prescribed value at boundary, that is,
\begin{equation}
	\phi_e = \phi_E
\end{equation}
and flux per unit of surface can be easily computed as
\begin{equation}
	j_e = -\Gamma_P \frac{\phi_e - \phi_P}{d_{Pe}}
\end{equation}
In contrast, when a Neumann boundary condition with flux $j_e$, the value at face is
\begin{equation}
	\phi_e = \phi_P - \frac{j_e d_{Pe}}{\Gamma_P}
\end{equation}
This second situation is pictured in figure \ref{fig:boundary_conditions_neumann}.